{% load static %}
{% load i18n %}
{% load i18n_extras %}
{% get_current_language as CURRENT_LANG %}
{% get_available_languages as LANGUAGES %}
{% get_language_info_list for LANGUAGES as languages %}

<!doctype html>
<html lang="{{ request.LANGUAGE_CODE }}">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>{% block title %}{{ site.company_name }}{% endblock %}</title>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
  {% comment %} <link href="{% static 'public/css/brand.css' %}" rel="stylesheet"> {% endcomment %}
<script>
document.addEventListener('DOMContentLoaded', () => {
  const DEFAULT_LANG = 'ru';
  const LANGS = [{% for code, name in LANGUAGES %}'{{ code }}'{% if not forloop.last %},{% endif %}{% endfor %}];

  function buildNext(targetLang) {
    const u = new URL(window.location.href);
    const hadSlash = u.pathname.endsWith('/');

    let parts = u.pathname.split('/').filter(Boolean); // ["ky","news"] или []
    const hasPrefix = parts.length && LANGS.includes(parts[0]) && parts[0] !== DEFAULT_LANG;

    if (targetLang === DEFAULT_LANG) {
      if (hasPrefix) parts.shift();
    } else {
      if (hasPrefix) parts[0] = targetLang;
      else parts.unshift(targetLang);
    }

    let path = '/' + parts.join('/');
    if (hadSlash && !path.endsWith('/')) path += '/';

    return path + u.search + u.hash;
  }

  document.querySelectorAll('[data-lang-form]').forEach((form) => {
    const nextInput = form.querySelector('input[name="next"]');
    form.querySelectorAll('button[name="language"]').forEach((btn) => {
      btn.addEventListener('click', () => {
        nextInput.value = buildNext(btn.value);
      });
    });
  });
});
</script>

  <link rel="icon" href="{% static 'img/logo.png' %}">
</head>
<body>
<style>:root{
  --kp-primary:#1090F0;
  --kp-primary-2:#0B5ED7;
  --kp-bg:#F5F9FF;
  --kp-dark:#0B1320;
  --kp-soft:#E8F3FF;
  --kp-radius:22px;
}

body{
  background: var(--kp-bg);
  color: var(--kp-dark);
}
.mobile{
  display: none;
}
@media (max-width: 767px){
  .mobile{ display: block;}
}
.kp-navbar{
  background: rgba(255,255,255,.86);
  backdrop-filter: blur(10px);
  border-bottom: 1px solid rgba(16,144,240,.12);
}

.kp-brand{
  display:flex; gap:12px; align-items:center;
  font-weight:800; letter-spacing:.2px;
}

.kp-btn{
  border-radius: 999px;
  padding: 12px 18px;
  font-weight: 700;
}

.kp-btn-primary{
  background: linear-gradient(135deg, var(--kp-primary), var(--kp-primary-2));
  color:#fff;
  border:0;
  box-shadow: 0 18px 40px rgba(16,144,240,.25);
}
.kp-btn-primary:hover{ filter: brightness(0.98); transform: translateY(-1px); }

.kp-hero{
  border-radius: var(--kp-radius);
  background:
    radial-gradient(1200px 500px at 10% 10%, rgba(16,144,240,.35), transparent 55%),
    radial-gradient(900px 400px at 90% 20%, rgba(11,94,215,.28), transparent 55%),
    linear-gradient(180deg, #ffffff, var(--kp-soft));
  border: 1px solid rgba(16,144,240,.12);
  overflow:hidden;
}

.kp-card{
  border-radius: var(--kp-radius);
  border: 1px solid rgba(16,144,240,.10);
  background: rgba(255,255,255,.88);
  box-shadow: 0 10px 30px rgba(11,19,32,.06);
  transition: .2s ease;
}
.kp-card:hover{ transform: translateY(-3px); box-shadow: 0 20px 60px rgba(11,19,32,.10); }

.kp-section-title{
  font-weight: 900;
  letter-spacing: .2px;
}
</style>
<nav class="navbar navbar-expand-lg kp-navbar sticky-top">
  <div class="container py-2">
    <a class="navbar-brand kp-brand" href="{% url 'public:home' %}">
      <img src="{% static '/img/logo.png' %}" alt="logo" style="height:42px;border-radius:12px;">
      <span>Kunguroff &amp; Partners</span>
    </a>

    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#nav">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse" id="nav">
      <ul class="navbar-nav ms-auto gap-lg-2">
        <li>
        

<form action="{% url 'set_language' %}" method="post" class="d-none d-md-block" data-lang-form>
    {% csrf_token %}
    <input type="hidden" name="next" value="{{ request.get_full_path }}">


    <div class="dropdown">
        <button class="btn btn-sm btn-outline-secondary rounded-pill dropdown-toggle"
                type="button" data-bs-toggle="dropdown" aria-expanded="false">
            {% if CURRENT_LANG == "ru" %}RU{% elif CURRENT_LANG == "ky" %}KY{% else %}EN{% endif %}
        </button>
        <ul class="dropdown-menu dropdown-menu-end">
            {% for lang in languages %}
                <li>
                    <button class="dropdown-item {% if lang.code == CURRENT_LANG %}active{% endif %}"
                            type="submit" name="language" value="{{ lang.code }}">
                        {{ lang.name_local }}
                    </button>
                </li>
            {% endfor %}
        </ul>
    </div>
</form>

</li>
        <li class="nav-item"><a class="nav-link" href="{% url 'public:staff' %}">{% trans "Сотрудники" %}</a></li>
        <li class="nav-item"><a class="nav-link" href="{% url 'public:casess' %}">{% trans "Дела" %}</a></li>
        <li class="nav-item"><a class="nav-link" href="{% url 'public:news' %}">{% trans "Новости" %}</a></li>
        <li class="nav-item"><a class="nav-link" href="{% url 'public:about' %}">{% trans "О нас" %}</a></li>
        <li class="nav-item"><a class="nav-link" href="{% url 'public:contacts' %}">{% trans "Контакты" %}</a></li>
        <li class="nav-item"><a class="nav-link" href="{% url 'login' %}">{% trans "Войти" %}</a></li>
        <li class="mobile">  <div class="text-muted" style="font-size:12px; text-transform:uppercase; letter-spacing:.12em;">
        {% trans "Язык" %}
    </div>

    <form action="{% url 'set_language' %}" method="post" class="d-flex gap-2 mt-2" data-lang-form>
        {% csrf_token %}
        <input type="hidden" name="next" value="{{ request.get_full_path }}">

        <button class="btn btn-sm btn-outline-secondary rounded-pill" type="submit" name="language" value="ru">RU</button>
        <button class="btn btn-sm btn-outline-secondary rounded-pill" type="submit" name="language" value="ky">KY</button>
        <button class="btn btn-sm btn-outline-secondary rounded-pill" type="submit" name="language" value="en">EN</button>
    </form></li>
      </ul>
      <div class="mt-2">
  
</div>

      <a class="btn kp-btn kp-btn-primary ms-lg-3" href="{% url 'public:contacts' %}#consult">
        {% trans "Консультация" %}
      </a>
    </div>
  </div>
</nav>

<div class="container mt-3">
  {% if messages %}
    {% for m in messages %}
      <div class="alert alert-{{ m.tags }} mb-2">{{ m }}</div>
    {% endfor %}
  {% endif %}
</div>

<main class="container my-4">
  {% block content %}{% endblock %}
</main>

<footer class="py-5 mt-5" style="background: #fff; border-top:1px solid rgba(16,144,240,.12);">
  <div class="container">
    <div class="row g-4">
      <div class="col-lg-5">
        <div class="d-flex align-items-center gap-2">
          <img src="{% static '/img/logo.png' %}" alt="logo" style="height:38px;border-radius:12px;">
          <div>
            <div class="fw-bold">{{ site.company_name|default:"Kunguroff & Partners" }}</div>
            <div class="text-muted small">{{ site.slogan|default:"Stand for your rights" }}</div>
          </div>
        </div>
        <div class="text-muted small mt-3">© {% now "Y" %}{% trans ". Все права защищены." %}</div>
      </div>
      <div class="col-lg-7">
        <div class="row g-3">
          <div class="col-md-6">
            <div class="fw-bold mb-1">{% trans "Контакты" %}</div>
            <div class="text-muted small">{{ site.address }}</div>
            <div class="text-muted small">{{ site.work_hours }}</div>
          </div>
          <div class="col-md-6">
            <div class="fw-bold mb-1">Связь</div>
            <div class="text-muted small">{{ site.phone }}</div>
            <div class="text-muted small">{{ site.email }}</div>
          </div>
        </div>
      </div>
    </div>
  </div>
</footer>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>



</html>
